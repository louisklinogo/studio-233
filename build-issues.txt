, "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
prisma:query COMMIT
{
  level: 'info',
  event: 'agent.context.latest_image_detected',
  ts: '2025-12-30T06:54:28.948Z',
  imageUrl: 'https://2lkalc8atjuztgjx.public.blob.vercel-storage.com/default-samples/077b8fd4-b483-4032-b4bb-16e97300d431.jpg-1765990242056-AmTfh3zPhHjNcC32NUDxBcX7NKGjah.png',
  count: 1,
  agent: 'orchestrator'
}
 PUT /api/inngest 200 in 2.5s (compile: 826ms, render: 1672ms)
 PUT /api/inngest 200 in 94ms (compile: 54ms, render: 40ms)
{
  level: 'error',
  event: 'vision_analysis.download_failed',
  ts: '2025-12-30T06:54:42.001Z',
  imageUrl: 'https://2lkalc8atjuztgjx.public.blob.vercel-storage.com/default-samples/077b8fd4-b483-4032-b4bb-16e97300d431.jpg-1765990242056-AmTfh3zPhHjNcC32NUDxBcX7NKGjah.png',
  error: 'Bun is not defined',
  mode: 'full',
  toolCallId: 'sSGxDiqJiowGeRqs',
  threadId: 'cmjs8f3af0004t9cr005vkh8x'
}
{
  level: 'error',
  event: 'tool.vision-analysis.failed',
  ts: '2025-12-30T06:54:42.003Z',
  durationMs: 483,
  message: 'Bun is not defined',
  parameterKeys: []
}
{
  level: 'info',
  event: 'agent.orchestrator.stream_step_finish',
  ts: '2025-12-30T06:54:42.112Z',
  toolCalls: [ { name: 'visionAnalysis', args: {} } ],
  finishReason: 'tool-calls'
}
ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
 тип unhandledRejection: ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
 тип unhandledRejection:  ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
prisma:query INSERT INTO "public"."agent_tool_call" ("id","threadId","name","arguments","status","createdAt") VALUES ($1,$2,$3,$4,CAST($5::text AS "public"."ToolCallStatus"),$6) ON CONFLICT ("id") DO UPDATE SET "name" = $7, "arguments" = $8, "status" = CAST($9::text AS "public"."ToolCallStatus") WHERE ("public"."agent_tool_call"."id" = $10 AND 1=1) RETURNING "public"."agent_tool_call"."id", "public"."agent_tool_call"."threadId", "public"."agent_tool_call"."name", "public"."agent_tool_call"."arguments", "public"."agent_tool_call"."result", "public"."agent_tool_call"."status"::text, "public"."agent_tool_call"."latencyMs", "public"."agent_tool_call"."createdAt", "public"."agent_tool_call"."completedAt"
 PUT /api/inngest 200 in 65ms (compile: 25ms, render: 40ms)
{
  level: 'error',
  event: 'vision_analysis.download_failed',
  ts: '2025-12-30T06:54:47.605Z',
  imageUrl: 'https://2lkalc8atjuztgjx.public.blob.vercel-storage.com/default-samples/077b8fd4-b483-4032-b4bb-16e97300d431.jpg-1765990242056-AmTfh3zPhHjNcC32NUDxBcX7NKGjah.png',
  error: 'Bun is not defined',
  mode: 'full',
  toolCallId: 'V749jg6dp17b4iIE',
  threadId: 'cmjs8f3af0004t9cr005vkh8x'
}
{
  level: 'error',
  event: 'tool.vision-analysis.failed',
  ts: '2025-12-30T06:54:47.607Z',
  durationMs: 674,
  message: 'Bun is not defined',
  parameterKeys: [ 'mode', 'imageUrl' ]
}
{
  level: 'info',
  event: 'agent.orchestrator.stream_step_finish',
  ts: '2025-12-30T06:54:47.615Z',
  toolCalls: [ { name: 'visionAnalysis', args: [Object] } ],
  finishReason: 'tool-calls'
}
ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
 тип unhandledRejection: ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
 тип unhandledRejection:  ReferenceError: Bun is not defined
    at computeSHA256 (../../packages/ai/src/utils/hashing.ts:8:17)
    at Object.runVisionAnalysisWorkflow [as run] (../../packages/ai/src/workflows/vision-analysis.ts:156:36)
    at async toolOptions.execute (../../packages/ai/src/runtime/tools.ts:111:12)
   6 |  input: string | Buffer | Uint8Array | ReadableStream<Uint8Array>,
   7 | ): Promise<string> {
>  8 |  const hasher = new Bun.CryptoHasher("sha256");
     |                 ^
   9 |
  10 |  if (input instanceof ReadableStream) {
  11 |          const reader = input.getReader();
prisma:query INSERT INTO "public"."agent_tool_call" ("id","threadId","name","arguments","status","createdAt") VALUES ($1,$2,$3,$4,CAST($5::text AS "public"."ToolCallStatus"),$6) ON CONFLICT ("id") DO UPDATE SET "name" = $7, "arguments" = $8, "status" = CAST($9::text AS "public"."ToolCallStatus") WHERE ("public"."agent_tool_call"."id" = $10 AND 1=1) RETURNING "public"."agent_tool_call"."id", "public"."agent_tool_call"."threadId", "public"."agent_tool_call"."name", "public"."agent_tool_call"."arguments", "public"."agent_tool_call"."result", "public"."agent_tool_call"."status"::text, "public"."agent_tool_call"."latencyMs", "public"."agent_tool_call"."createdAt", "public"."agent_tool_call"."completedAt"
 PUT /api/inngest 200 in 70ms (compile: 29ms, render: 41ms)
prisma:query INSERT INTO "public"."agent_message" ("id","threadId","role","type","content","createdAt") VALUES ($1,$2,CAST($3::text AS "public"."AgentMessageRole"),CAST($4::text AS "public"."AgentMessageType"),$5,$6) RETURNING "public"."agent_message"."id", "public"."agent_message"."threadId", "public"."agent_message"."role"::text, "public"."agent_message"."type"::text, "public"."agent_message"."content", "public"."agent_message"."inputTokens", "public"."agent_message"."outputTokens", "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
prisma:query INSERT INTO "public"."agent_message" ("id","threadId","role","type","content","createdAt") VALUES ($1,$2,CAST($3::text AS "public"."AgentMessageRole"),CAST($4::text AS "public"."AgentMessageType"),$5,$6) RETURNING "public"."agent_message"."id", "public"."agent_message"."threadId", "public"."agent_message"."role"::text, "public"."agent_message"."type"::text, "public"."agent_message"."content", "public"."agent_message"."inputTokens", "public"."agent_message"."outputTokens", "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
prisma:query UPDATE "public"."agent_tool_call" SET "status" = CAST($1::text AS "public"."ToolCallStatus"), "result" = $2, "completedAt" = $3 WHERE ("public"."agent_tool_call"."id" = $4 AND 1=1) RETURNING "public"."agent_tool_call"."id", "public"."agent_tool_call"."threadId", "public"."agent_tool_call"."name", "public"."agent_tool_call"."arguments", "public"."agent_tool_call"."result", "public"."agent_tool_call"."status"::text, "public"."agent_tool_call"."latencyMs", "public"."agent_tool_call"."createdAt", "public"."agent_tool_call"."completedAt"
prisma:query INSERT INTO "public"."agent_message" ("id","threadId","role","type","content","createdAt") VALUES ($1,$2,CAST($3::text AS "public"."AgentMessageRole"),CAST($4::text AS "public"."AgentMessageType"),$5,$6) RETURNING "public"."agent_message"."id", "public"."agent_message"."threadId", "public"."agent_message"."role"::text, "public"."agent_message"."type"::text, "public"."agent_message"."content", "public"."agent_message"."inputTokens", "public"."agent_message"."outputTokens", "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
prisma:query INSERT INTO "public"."agent_message" ("id","threadId","role","type","content","createdAt") VALUES ($1,$2,CAST($3::text AS "public"."AgentMessageRole"),CAST($4::text AS "public"."AgentMessageType"),$5,$6) RETURNING "public"."agent_message"."id", "public"."agent_message"."threadId", "public"."agent_message"."role"::text, "public"."agent_message"."type"::text, "public"."agent_message"."content", "public"."agent_message"."inputTokens", "public"."agent_message"."outputTokens", "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
prisma:query UPDATE "public"."agent_tool_call" SET "status" = CAST($1::text AS "public"."ToolCallStatus"), "result" = $2, "completedAt" = $3 WHERE ("public"."agent_tool_call"."id" = $4 AND 1=1) RETURNING "public"."agent_tool_call"."id", "public"."agent_tool_call"."threadId", "public"."agent_tool_call"."name", "public"."agent_tool_call"."arguments", "public"."agent_tool_call"."result", "public"."agent_tool_call"."status"::text, "public"."agent_tool_call"."latencyMs", "public"."agent_tool_call"."createdAt", "public"."agent_tool_call"."completedAt"
prisma:query INSERT INTO "public"."agent_message" ("id","threadId","role","type","content","createdAt") VALUES ($1,$2,CAST($3::text AS "public"."AgentMessageRole"),CAST($4::text AS "public"."AgentMessageType"),$5,$6) RETURNING "public"."agent_message"."id", "public"."agent_message"."threadId", "public"."agent_message"."role"::text, "public"."agent_message"."type"::text, "public"."agent_message"."content", "public"."agent_message"."inputTokens", "public"."agent_message"."outputTokens", "public"."agent_message"."toolCallId", "public"."agent_message"."createdAt"
 POST /api/chat 200 in 48s (compile: 20.9s, render: 27.1s)
 PUT /api/inngest 200 in 153ms (compile: 30ms, render: 124ms)
 PUT /api/inngest 200 in 175ms (compile: 51ms, render: 123ms)
